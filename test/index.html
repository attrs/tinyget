<!DOCTYPE html>

<html>
<head>
  <title>tinyget</title>
  <meta charset="utf-8">
  
  <!--[if lt IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-shim.min.js"></script>
  <![endif]-->
  
  <script type="text/commonjs">
    var tinyget = require('tinyget');
    
    function test(conn, done) {
      // #1
      conn('data.json').qry({key: 'value'}).exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#1', result);
      });
    
      // #2
      conn({
        url: 'data.text',
        payload: {key:'value'}
      }).exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#2', result);
      });
    
      // #3
      conn({
        url: 'data.xml',
        qry: {a:'b'},
        payload: {key:'value'}
      }, function(err, result) {
        if( err ) return console.info(err);
        console.log('#3', result);
      });
    
      // #4
      conn('data.json').type('text').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#4', result);
      });
    
      // #5
      conn('data.json').type('json').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#5', result);
      });
    
      // #6
      conn('data.xml').type('text').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#6', result);
      });
    
      // #7
      conn('data.text').type('json').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#7', result);
      });
    
      // #8
      conn('data.html').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#8', result);
      });
    
      // #9
      conn('data.html').type('document').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#9', result);
      });
    
      // #10
      conn('../data.html').type('text').exec(function(err, result) {
        if( err ) return console.info(err);
        console.log('#10', result);
        
        done();
      });
    }
    
    console.info('using default connection');
    test(tinyget, function() {
      console.info('using branched connection');
      test(tinyget.endpoint('http://127.0.0.1:9000/'));
    });
  </script>
  
  <script src="/web_modules/webmodules/runtime.js"></script>
</head>
<body>
</body>
</html>
