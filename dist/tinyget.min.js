/*! tinyget attrs */!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Tinyget",[],e):"object"==typeof exports?exports.Tinyget=e():t.Tinyget=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function r(t){var e={};if(!t)return e;for(var n=t.split("\r\n"),r=0,o=n.length;r<o;r++){var s=n[r],i=s.indexOf(": ");if(i>0){var a=s.substring(0,i),u=s.substring(i+2);a=a&&a.split("\r").join("").split("\n").join(""),u=u&&u.split("\r").join("").split("\n").join(""),e[a]=u}}return e}function o(t){return{status:t.status,headers:r(t.getAllResponseHeaders()),text:t.responseText,data:t.response||t.responseXML}}var s=n(1),i=n(8);i.impl.connector=function(t,e){var n=t.url,r=t.method,i=t.payload,a=t.sync,u=t.credentials,h=t.headers,c=t.responseType,l=t.onprogress,f=t.xdr,p=function(){if(n&&~n.indexOf("://")){var t=s.parse(n);if(t.hostname&&t.hostname!==document.domain)return!0}return!1}();if(p&&f&&window.XDomainRequest){if(!window.XDomainRequest)return e(new Error("browser does not support CORS ajax request"));var d=new XDomainRequest;d.onload=function(t){e(null,{status:200,text:d.responseText})},d.onerror=function(t){e(new Error("[tinyget] ajax error("+d.status+") "+r+' "'+n+'"'),{status:500,text:d.responseText})},d.onprogress=function(t){l&&l.call(d,t)},d.ontimeout=function(t){e(new Error("[tinyget] ajax error(timeout) "+r+' "'+n+'"'),{status:500})},d.open(r,n);for(var y in h)console.warn("[tinyget] XDomainRequest cannot set request header, header ignored ",y,h[y]);return c&&(d.responseType=c),void(i?d.send(i):d.send())}var m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");l&&(m.upload?m.upload.addEventListener("progress",function(t){l.call(m,t)},!1):console.warn("[tinyget] browser does not support upload progress.")),"onload"in m?(m.onload=function(t){e(null,o(m))},m.onerror=function(t){e(new Error("[tinyget] ajax error("+m.status+") "+r+' "'+n+'"'),o(m))}):m.onreadystatechange=function(t){4==m.readyState&&e(null,o(m))},m.onprogress=function(t){l&&l.call(m,t)},m.onabort=function(t){e(new Error("[tinyget] ajax error(aborted) "+r+' "'+n+'"'),o(m))},m.ontimeout=function(t){e(new Error("[tinyget] ajax error(timeout) "+r+' "'+n+'"'),o(m))},m.open(r,n,!a),m.withCredentials=!!u;for(var y in h)m.setRequestHeader(y,h[y]);c&&(m.responseType=c),i?m.send(i):m.send()},i.impl.toXml=function(t){return(new DOMParser).parseFromString(t,"text/xml")},i.impl.toDocument=function(t){return(new DOMParser).parseFromString(t,"text/html")},t.exports=i},function(t,e,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&h.isObject(t)&&t instanceof r)return t;var o=new r;return o.parse(t,e,n),o}function s(t){return h.isString(t)&&(t=o(t)),t instanceof r?t.format():r.prototype.format.call(t)}function i(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var u=n(2),h=n(4);e.parse=o,e.resolve=i,e.resolveObject=a,e.format=s,e.Url=r;var c=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),y=["'"].concat(d),m=["%","/","?",";","#"].concat(y),g=["/","?","#"],v=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},j={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},O=n(5);r.prototype.parse=function(t,e,n){if(!h.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=r!==-1&&r<t.indexOf("#")?"?":"#",s=t.split(o),i=/\\/g;s[0]=s[0].replace(i,"/"),t=s.join(o);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var l=f.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=O.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=c.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var q="//"===a.substr(0,2);!q||p&&j[p]||(a=a.substr(2),this.slashes=!0)}if(!j[p]&&(q||p&&!T[p])){for(var k=-1,A=0;A<g.length;A++){var C=a.indexOf(g[A]);C!==-1&&(k===-1||C<k)&&(k=C)}var E,R;R=k===-1?a.lastIndexOf("@"):a.lastIndexOf("@",k),R!==-1&&(E=a.slice(0,R),a=a.slice(R+1),this.auth=decodeURIComponent(E)),k=-1;for(var A=0;A<m.length;A++){var C=a.indexOf(m[A]);C!==-1&&(k===-1||C<k)&&(k=C)}k===-1&&(k=a.length),this.host=a.slice(0,k),a=a.slice(k),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var S=this.hostname.split(/\./),A=0,U=S.length;A<U;A++){var D=S[A];if(D&&!D.match(b)){for(var L="",X=0,N=D.length;X<N;X++)L+=D.charCodeAt(X)>127?"x":D[X];if(!L.match(b)){var F=S.slice(0,A),M=S.slice(A+1),H=D.match(w);H&&(F.push(H[1]),M.unshift(H[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=F.join(".");break}}}this.hostname.length>v?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=u.toASCII(this.hostname));var P=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+P,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!x[d])for(var A=0,U=y.length;A<U;A++){var $=y[A];if(a.indexOf($)!==-1){var J=encodeURIComponent($);J===$&&(J=escape($)),a=a.split($).join(J)}}var _=a.indexOf("#");_!==-1&&(this.hash=a.substr(_),a=a.slice(0,_));var K=a.indexOf("?");if(K!==-1?(this.search=a.substr(K),this.query=a.substr(K+1),e&&(this.query=O.parse(this.query)),a=a.slice(0,K)):e&&(this.search="",this.query={}),a&&(this.pathname=a),T[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var P=this.pathname||"",Z=this.search||"";this.path=P+Z}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(s=O.stringify(this.query));var i=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||T[e])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),i=i.replace("#","%23"),e+o+n+i+r},r.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(h.isString(t)){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,o=Object.keys(this),s=0;s<o.length;s++){var i=o[s];n[i]=this[i]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var c=a[u];"protocol"!==c&&(n[c]=t[c])}return T[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!T[t.protocol]){for(var l=Object.keys(t),f=0;f<l.length;f++){var p=l[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||j[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var y=n.pathname||"",m=n.search||"";n.path=y+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var g=n.pathname&&"/"===n.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=v||g||n.host&&t.pathname,w=b,x=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],O=n.protocol&&!T[n.protocol];if(O&&(n.hostname="",n.port=null,n.host&&(""===x[0]?x[0]=n.host:x.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===x[0])),v)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,x=d;else if(d.length)x||(x=[]),x.pop(),x=x.concat(d),n.search=t.search,n.query=t.query;else if(!h.isNullOrUndefined(t.search)){if(O){n.hostname=n.host=x.shift();var q=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");q&&(n.auth=q.shift(),n.host=n.hostname=q.shift())}return n.search=t.search,n.query=t.query,h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=x.slice(-1)[0],A=(n.host||t.host||x.length>1)&&("."===k||".."===k)||""===k,C=0,E=x.length;E>=0;E--)k=x[E],"."===k?x.splice(E,1):".."===k?(x.splice(E,1),C++):C&&(x.splice(E,1),C--);if(!b&&!w)for(;C--;C)x.unshift("..");!b||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),A&&"/"!==x.join("/").substr(-1)&&x.push("");var R=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(O){n.hostname=n.host=R?"":x.length?x.shift():"";var q=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");q&&(n.auth=q.shift(),n.host=n.hostname=q.shift())}return b=b||n.host&&x.length,b&&!R&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null),h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=l.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){var r;(function(t,o){!function(s){function i(t){throw RangeError(S[t])}function a(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function u(t,e){var n=t.split("@"),r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(I,".");var o=t.split("."),s=a(o,e).join(".");return r+s}function h(t){for(var e,n,r=[],o=0,s=t.length;o<s;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<s?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function c(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=L(t>>>10&1023|55296),t=56320|1023&t),e+=L(t)}).join("")}function l(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:x}function f(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var r=0;for(t=n?D(t/q):t>>1,t+=D(t/e);t>U*T>>1;r+=x)t=D(t/U);return D(r+(U+1)*t/(t+O))}function d(t){var e,n,r,o,s,a,u,h,f,d,y=[],m=t.length,g=0,v=A,b=k;for(n=t.lastIndexOf(C),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&i("not-basic"),y.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<m;){for(s=g,a=1,u=x;o>=m&&i("invalid-input"),h=l(t.charCodeAt(o++)),(h>=x||h>D((w-g)/a))&&i("overflow"),g+=h*a,f=u<=b?j:u>=b+T?T:u-b,!(h<f);u+=x)d=x-f,a>D(w/d)&&i("overflow"),a*=d;e=y.length+1,b=p(g-s,e,0==s),D(g/e)>w-v&&i("overflow"),v+=D(g/e),g%=e,y.splice(g++,0,v)}return c(y)}function y(t){var e,n,r,o,s,a,u,c,l,d,y,m,g,v,b,O=[];for(t=h(t),m=t.length,e=A,n=0,s=k,a=0;a<m;++a)y=t[a],y<128&&O.push(L(y));for(r=o=O.length,o&&O.push(C);r<m;){for(u=w,a=0;a<m;++a)y=t[a],y>=e&&y<u&&(u=y);for(g=r+1,u-e>D((w-n)/g)&&i("overflow"),n+=(u-e)*g,e=u,a=0;a<m;++a)if(y=t[a],y<e&&++n>w&&i("overflow"),y==e){for(c=n,l=x;d=l<=s?j:l>=s+T?T:l-s,!(c<d);l+=x)b=c-d,v=x-d,O.push(L(f(d+b%v,0))),c=D(b/v);O.push(L(f(c,0))),s=p(n,g,r==o),n=0,++r}++n,++e}return O.join("")}function m(t){return u(t,function(t){return E.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return u(t,function(t){return R.test(t)?"xn--"+y(t):t})}var v=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);v.global!==v&&v.window!==v&&v.self!==v||(s=v);var b,w=2147483647,x=36,j=1,T=26,O=38,q=700,k=72,A=128,C="-",E=/^xn--/,R=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},U=x-j,D=Math.floor,L=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:h,encode:c},decode:d,encode:y,toASCII:g,toUnicode:m},r=function(){return b}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)}).call(e,n(3)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(6),e.encode=e.stringify=n(7)},function(t,e){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var i=/\+/g;t=t.split(e);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var u=t.length;a>0&&u>a&&(u=a);for(var h=0;h<u;++h){var c,l,f,p,d=t[h].replace(i,"%20"),y=d.indexOf(r);y>=0?(c=d.substr(0,y),l=d.substr(y+1)):(c=d,l=""),f=decodeURIComponent(c),p=decodeURIComponent(l),n(s,f)?Array.isArray(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s}},function(t,e){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,o){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(o){var s=encodeURIComponent(n(o))+r;return Array.isArray(t[o])?t[o].map(function(t){return s+encodeURIComponent(n(t))}).join(e):s+encodeURIComponent(n(t[o]))}).join(e):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(t)):""}},function(t,e,n){function r(t){if(!t||"object"!=typeof t)return"";var e={};for(var n in t){var r=t[n];null!==r&&void 0!==r&&(e[n]=r)}return a.stringify(e)}function o(t){return""===t||null===t||void 0===t}function s(t){function e(s,a){s=s||{},"string"==typeof s&&(s={url:s});var u={options:function(t,e){if(!arguments.length)return s;e&&this.clear();for(var n in t)s[n]=t[n];return this},clear:function(){var t=s;return s={},t.url&&(s.url=t.url),this},method:function(t){return s.method=t||"get",this},url:function(t){return arguments.length?(s.url=t,this):s.url},payload:function(t){return arguments.length?(s.payload=t,this):s.payload||s.body},qry:function(t){return arguments.length?(s.qry=t,this):s.qry},hook:function(t,e){return 1===arguments.length&&t===!1?(s.hooks=!1,this):arguments.length?1===arguments.length?s.hooks&&s.hooks[t]:"string"!=typeof t?console.error("hook type must be a string:"+t):(s.hooks=s.hooks||{},s.hooks[t]=e,this):s.hooks},ondone:function(t){return s.ondone=t,this},onsuccess:function(t){return s.onsuccess=t,this},onerror:function(t){return s.onerror=t,this},onprogress:function(t){return s.onprogress=t,this},cache:function(t){return arguments.length?("boolean"==typeof t&&(s.cache=t),this):s.cache},sync:function(t){return arguments.length?("boolean"==typeof b&&(s.sync=t),this):s.sync},credentials:function(t){return arguments.length?("boolean"==typeof t&&(s.credentials=t),this):s.credentials},contentType:function(t){return arguments.length?(s.contentType=t,this):s.contentType},responseType:function(t){return arguments.length?(s.responseType=t,this):s.responseType},type:function(t){return arguments.length?(s.type=t,this):s.type},headers:function(t){return arguments.length?~["object","function"].indexOf(typeof t)?(s.headers=t||{},this):console.error("headers must be an object or function")||this:s.headers},header:function(t,e){if(!t)return console.error("missing header name")||this;if("string"!=typeof t)return console.error("header name must be a string")||this;if(1===arguments.length)return s.headers[t];if(s.headers){if("function"==typeof s.headers)return console.error("options.headers is function")||this}else s.headers={};return null==e?delete s.headers[t]:s.headers[t]=e,this},event:function(t){return s.event=t,this},get:e.get,post:e.post,put:e.put,"delete":e["delete"],exec:function(a){function h(s){var a={};for(var h in s)a[h]=s[h];a.method=(a.method||"get").toUpperCase(),a.payload=a.payload||a.body,a.sync=a.sync===!0,a.cache=a.cache!==!1,a.credentials=(a.credentials||a.withCredentials)!==!1,a.endpoint=e.endpoint(),a.headers=a.headers||{},"function"==typeof a.url&&(a.url=a.url.call(u,e,u)),"function"==typeof a.method&&(a.method=a.method.call(u,e,u)),"function"==typeof a.qry&&(a.qry=a.qry.call(u,e,u)),"function"==typeof a.payload&&(a.payload=a.payload.call(u,e,u)),"function"==typeof a.headers&&(a.headers=a.headers.call(u,e,u)),"function"==typeof a.contentType&&(a.contentType=a.contentType.call(u,e,u)),"function"==typeof a.responseType&&(a.responseType=a.responseType.call(u,e,u)),"function"==typeof a.type&&(a.type=a.type.call(u,e,u)),"function"==typeof a.sync&&(a.sync=a.sync.call(u,e,u));var f=p;if(f)for(var h in f)h in a.headers||o(f[h])||(a.headers[h]=f[h]);if(f=t&&t.headers())for(var h in p)h in a.headers||o(f[h])||(a.headers[h]=f[h]);return a.url?"string"!=typeof a.url?fn(new Error("url must be a string: "+typeof a.url)):(a.qry&&("object"==typeof a.qry&&(a.qry=r(a.qry)),"string"==typeof a.qry&&a.qry&&(~a.url.indexOf("?")?a.url=a.url+"&"+a.qry:a.url=a.url+"?"+a.qry)),a.cache||(~a.url.indexOf("?")?a.url=a.url+"&_ts="+(new Date).getTime():a.url=a.url+"?_ts="+(new Date).getTime()),a.payload&&("FormData"in window&&a.payload instanceof FormData?a.payload=a.payload:a.contentType&&~a.contentType.indexOf("json")?a.payload="object"==typeof a.payload?JSON.stringify(a.payload):a.payload.toString():a.contentType||"application/x-www-form-urlencoded"!==a.contentType?a.contentType||"object"!=typeof a.payload?a.ontentType||"string"!=typeof a.payload||(a.contentType="application/x-www-form-urlencoded"):(a.contentType="application/json",a.payload=JSON.stringify(a.payload)):a.payload="string"==typeof a.payload?a.payload:r(a.payload)),a.contentType&&(a.headers["Content-Type"]=a.contentType),"/"===a.url.trim()[0]&&(a.url="."+a.url),a.url=i.resolve(a.endpoint,a.url),a.debug&&console.info("[tinyget] conn",a.url),l&&n.fire("connect",{options:a}),void c.connector(a,function(t,e){function r(t,e){if(e)try{var r,o=e.text,s=e.data,i=e.headers=e.headers||{};for(var h in i)i[h.toLowerCase()]=i[h];var f=i["content-type"]||a.type||a.contentType,p=a.responseType;r=p?"document"===p?s&&"string"!=typeof s?s:c.toDocument(s||o):"xml"===p?s&&"string"!=typeof s?s:c.toXml(s||o):"json"===p?s||JSON.parse(o):s||o:f&&~f.indexOf("/xml")?s&&"string"!=typeof s?s:c.toXml(s||o):f&&~f.indexOf("/html")?s&&"string"!=typeof s?s:c.toDocument(s||o):f&&~f.indexOf("/json")?o&&JSON.parse(o)||null:o,l&&n.fire("load",{response:e,data:r})}catch(y){t=t||y}m.callback.call(u,{options:a,error:t,data:r,response:e},function(t,n){a.onerror&&t&&a.onerror.call(u,t,e),a.onsuccess&&!t&&a.onsuccess.call(u,n,e),a.ondone&&a.ondone.call(u,t,n,e),d.apply(u,arguments)})}!t&&(e.status<200||e.status>=300)&&(t=new Error("[tinyget] error status("+e.status+"): "+a.method+' "'+a.url+'"')),l&&n.fire("response",{options:a,error:t,response:e}),m.after.call(u,{options:a,error:t,response:e},r)})):d(new Error("missing url"))}if(!s)return d(new Error("missing options"));if(!c.connector)return d(new Error("connector impl not found"));"function"!=typeof a&&(a=function(){});var l=s.event!==!1,d=function(t,e,r){t?l&&n.fire("error",{options:s,response:r,data:e,error:t}):l&&n.fire("success",{options:s,response:r,data:e}),l&&n.fire("done",{options:s,response:r,error:t,data:e}),a.apply(this,arguments)};l&&n.fire("start",{options:s});var y=s.hooks,m={before:y&&"before"in y||e.hook("before"),after:y&&"after"in y||e.hook("after"),callback:y&&"callback"in y||e.hook("callback")};return y!==!1&&m.before||(m.before=f.before),y!==!1&&m.after||(m.after=f.after),y!==!1&&m.callback||(m.callback=f.callback),m.before.call(u,s,function(t,e){return t?m.callback.call(u,{error:t},d):void h(e)}),this}};return"function"==typeof a?u.exec(a):u}var n=u();e.parent=function(){return t};var a;e.branchendpoint=function(t){return a},e.resolve=function(t){var n=e.endpoint(),r=t&&(~t.indexOf("://")?t:i.resolve(n,t))||n;return"/"!==r[r.length-1]?r+"/":r},e.endpoint=function(e){if(!arguments.length){var n=t&&t.endpoint()||"/",r=a&&(~a.indexOf("://")?a:i.resolve(n,a))||n;return r="/"!==r[r.length-1]?r+"/":r}if(!e)return this;if("string"!=typeof e)throw new TypeError("endpoint must be a string: "+e);return a=e,this},e.branch=function(t){if(t&&"string"!=typeof t)throw new TypeError("endpoint must be a string: "+t);var n=new s(e);return n.endpoint(t),h&&console.info("[tinyget] new branch",n.endpoint()),n},e.hooks={},e.hook=function(n,r){if(1===arguments.length)return e.hooks[n]||t&&t.hooks[n]||f[n];if("string"!=typeof n)throw new TypeError("hook type must be a string:"+n);if("function"!=typeof r)throw new TypeError("hook fn must be a function:"+r);return e.hooks[n]=r,this},e.profile=function(t,n){return l[t]?(l[t](e),"function"==typeof n&&n(e),this):console.error("[tinyget] undefined profile",t)},e.rest=function(t){return e.profile("rest",t),this};var p;return e.header=function(t,e){return arguments.length<=1?p[t]:(p=p||{},p[t]=e,this)},e.headers=function(t,e){if(!arguments.length)return p;if("object"!=typeof t)return console.error("[tinyget] illegal arguments",t);p=e?{}:p||{};for(var n in t)p[n]=t[n];return this},e.get=function(t,n){return"string"==typeof t&&(t={url:t}),t=t||{},t.method="get",e(t).qry(n)},e.options=function(t,n){return"string"==typeof t&&(t={url:t}),t=t||{},t.method="options",e(t).qry(n)},e.post=function(t,n){return"string"==typeof t&&(t={url:t}),t=t||{},t.method="post",e(t).payload(n)},e.put=function(t,n){return"string"==typeof t&&(t={url:t}),t=t||{},t.method="put",e(t).payload(n)},e["delete"]=function(t,n){return"string"==typeof t&&(t={url:t}),t=t||{},t.method="delete",e(t).qry(n)},e.on=function(t,e){return n.on(t,e),this},e.once=function(t,e){return n.once(t,e),this},e.off=function(t,e){return n.off(t,e),this},e.event=function(t){return n.active(t),this},e}var i=n(1),a=n(5),u=(n(9),n(11)),h=!1,c={},l={rest:n(12)},f={before:function(t,e){e(null,t)},after:function(t,e){e(t.error||null,t.response||null)},callback:function(t,e){e(t.error||null,t.data||null,t.response||null)}},p=new s;p.Tinyget=s,p.impl=c,t.exports=p},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return o.exec(t).slice(1)};e.resolve=function(){for(var e="",o=!1,s=arguments.length-1;s>=-1&&!o;s--){var i=s>=0?arguments[s]:t.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,o="/"===i.charAt(0))}return e=n(r(e.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+e||"."},e.normalize=function(t){var o=e.isAbsolute(t),s="/"===i(t,-1);return t=n(r(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&s&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),s=r(n.split("/")),i=Math.min(o.length,s.length),a=i,u=0;u<i;u++)if(o[u]!==s[u]){a=u;break}for(var h=[],u=a;u<o.length;u++)h.push("..");return h=h.concat(s.slice(a)),h.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=s(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=s(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return s(t)[3]};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(e,n(10))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function s(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function i(){y&&p&&(y=!1,p.length?d=p.concat(d):m=-1,d.length&&a())}function a(){if(!y){var t=o(i);y=!0;for(var e=d.length;e;){for(p=d,d=[];++m<e;)p&&p[m].run();m=-1,e=d.length}p=null,y=!1,s(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var c,l,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var p,d=[],y=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||y||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=h,f.addListener=h,f.once=h,f.off=h,f.removeListener=h,f.removeAllListeners=h,f.emit=h,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){t.exports=function(){function t(t,e){o||(a[t]||[]).forEach(function(n){n({type:t,detail:e})})}function e(t,e){a[t]=a[t]||[],a[t].push(e)}function n(t,n){var o=function(e){return r(t,o),n(e)};e(t,o)}function r(t,e){var n=a[t];if(n)for(var r;~(r=n.indexOf(e));)n.splice(r,1)}function o(){o=!0}function s(){o=!1}function i(t){o=!t}var a={},o=!1;return{fire:t,on:e,once:n,off:r,pause:o,resume:s,active:i}}},function(t,e){t.exports=function(t){t.hook("callback",function(t,e){var n=t.error||null,r=t.data||null,o=t.response||null;if(n&&r&&r.error){n=new Error(r.message);for(var s in r)n[s]=r[s]}e(n,r,o)}).hook("before",function(t,e){t.type="application/json",t.xdr=!0,t.credentials=!0,t.headers=t.headers||{},e(null,t)})}}])});